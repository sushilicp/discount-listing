{% extends 'discounts/base.html' %}
{% block content %}
<div class="mb-8">
    <form class="flex flex-col md:flex-row md:space-x-4 space-y-4 md:space-y-0 items-center justify-center">
        <input type="text" name="search" value="{{ search_query }}" placeholder="Search by product or shop" class="p-3 border-2 border-blue-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 w-full md:w-1/3">
        <select name="category" class="p-3 border-2 border-blue-200 rounded-lg w-full md:w-1/5">
            <option value="">All Categories</option>
            {% for category in categories %}
                <option value="{{ category.0 }}" {% if category.0 == selected_category %}selected{% endif %}>{{ category.1 }}</option>
            {% endfor %}
        </select>
        <select name="date" class="p-3 border-2 border-blue-200 rounded-lg w-full md:w-1/5">
            <option value="">All Dates</option>
            <option value="today" {% if selected_date == 'today' %}selected{% endif %}>Today</option>
            <option value="tomorrow" {% if selected_date == 'tomorrow' %}selected{% endif %}>Tomorrow</option>
            <option value="week" {% if selected_date == 'week' %}selected{% endif %}>This Week</option>
        </select>
        <button type="submit" class="bg-gradient-to-r from-blue-600 to-blue-400 text-white font-bold px-6 py-3 rounded-lg shadow hover:from-blue-700 hover:to-blue-500 transition w-full md:w-auto">Filter</button>
    </form>
</div>

<h2 class="text-3xl font-extrabold text-blue-700 mb-6 text-center">Featured Discounts</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
    {% for discount in featured %}
        <div class="bg-gradient-to-br from-yellow-100 to-yellow-50 p-6 rounded-2xl shadow-lg border border-yellow-200 relative">
            <span class="absolute top-2 right-2 bg-yellow-400 text-xs font-bold px-3 py-1 rounded-full text-blue-900 shadow">FEATURED</span>
            <h3 class="text-xl font-bold text-blue-900 mb-2">{{ discount.title }}</h3>
            <p class="text-gray-700 mb-1"><span class="font-semibold">Shop:</span> {{ discount.shop.name }}</p>
            <p class="text-gray-700 mb-1"><span class="font-semibold">Category:</span> {{ discount.get_category_display }}</p>
            <p class="text-green-700 font-bold text-lg mb-1">{% if discount.is_percentage %}{{ discount.amount }}%{% else %}Rs {{ discount.amount }}{% endif %} off</p>
            <p class="text-gray-500 text-sm mb-2">Valid: {{ discount.start_date }} to {{ discount.end_date }}</p>
            <p class="text-gray-600 text-sm">{{ discount.description|truncatewords:20 }}</p>
        </div>
    {% empty %}
        <div class="col-span-3 text-center text-gray-400">No featured discounts available.</div>
    {% endfor %}
</div>

<h2 class="text-3xl font-extrabold text-blue-700 mb-6 text-center">All Discounts</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
    {% for discount in discounts %}
        <div class="bg-white p-6 rounded-2xl shadow-lg border border-blue-100 hover:shadow-2xl transition">
            <h3 class="text-xl font-bold text-blue-900 mb-2">{{ discount.title }}</h3>
            <p class="text-gray-700 mb-1"><span class="font-semibold">Shop:</span> {{ discount.shop.name }}</p>
            <p class="text-gray-700 mb-1"><span class="font-semibold">Category:</span> {{ discount.get_category_display }}</p>
            <p class="text-green-700 font-bold text-lg mb-1">{% if discount.is_percentage %}{{ discount.amount }}%{% else %}Rs {{ discount.amount }}{% endif %} off</p>
            <p class="text-gray-500 text-sm mb-2">Valid: {{ discount.start_date }} to {{ discount.end_date }}</p>
            <p class="text-gray-600 text-sm">{{ discount.description|truncatewords:20 }}</p>
        </div>
    {% empty %}
        <div class="col-span-3 text-center text-gray-400">No discounts found.</div>
    {% endfor %}
</div>
{% endblock %}